WITH day AS (SELECT round((kwh / date_part('day', CURRENT_TIMESTAMP) * date_part('days', date_trunc('month', CURRENT_TIMESTAMP) + interval '1 month' - date_trunc('month', CURRENT_TIMESTAMP)))::numeric, 2) AS projected_use FROM electricity_usage_monthly WHERE month = date_part('month', CURRENT_TIMESTAMP)), 
 hour AS (SELECT round((kwh / floor(date_part('epoch', timestamp - date_trunc('month', CURRENT_TIMESTAMP)) / 60 / 60) * date_part('days', date_trunc('month', CURRENT_TIMESTAMP) + interval '1 month' - date_trunc('month', CURRENT_TIMESTAMP)) * 24)::numeric, 2) AS projected_use FROM electricity_usage_monthly WHERE month = date_part('month', CURRENT_TIMESTAMP)), 
 minute AS (SELECT round((kwh / floor(date_part('epoch', timestamp - date_trunc('month', CURRENT_TIMESTAMP)) / 60) * date_part('days', date_trunc('month', CURRENT_TIMESTAMP) + interval '1 month' - date_trunc('month', CURRENT_TIMESTAMP)) * 24 * 60)::numeric, 2) AS projected_use FROM electricity_usage_monthly WHERE month = date_part('month', CURRENT_TIMESTAMP)), 
 second AS (SELECT round((kwh / date_part('epoch', timestamp - date_trunc('month', CURRENT_TIMESTAMP)) * date_part('epoch', date_trunc('month', CURRENT_TIMESTAMP) + interval '1 month' - date_trunc('month', CURRENT_TIMESTAMP)))::numeric, 2) AS projected_use FROM electricity_usage_monthly WHERE month = date_part('month', CURRENT_TIMESTAMP))
 INSERT INTO prediction_test (SELECT CURRENT_TIMESTAMP, day.projected_use, hour.projected_use, minute.projected_use, second.projected_use FROM day, hour, minute, second);

